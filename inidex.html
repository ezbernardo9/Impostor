<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Impostor de Fútbol</title>
  <style>
    :root{
      --bg:#0b1220;       /* azul noche */
      --card:#0f1730;     /* azul profundo */
      --accent:#00e887;   /* verde césped */
      --accent-2:#00b4d8; /* celeste pelota */
      --line:#1f2a4a;
      --text:#e8efff;
      --muted:#9fb2d9;
      --danger:#ff4d4d;
      --radius:16px;
      --container:1100px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:radial-gradient(1000px 600px at 120% -10%, #13315a 0%, #0b1220 45%, #0b1220 100%);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif;}
    .wrap{width:min(100% - 2rem,var(--container));margin-inline:auto;padding:1.25rem 0 2rem;}
    header{
      display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:1rem;
    }
    .brand{display:flex;align-items:center;gap:.75rem}
    .logo{
      width:44px;height:44px;border-radius:50%;
      background:conic-gradient(from 180deg,var(--accent),var(--accent-2));
      box-shadow:inset 0 0 0 3px #0b1220, 0 0 0 3px var(--line), var(--shadow);
      position:relative;
    }
    .logo:after{content:"⚽";position:absolute;inset:0;display:grid;place-items:center;font-size:22px;filter:drop-shadow(0 2px 2px rgba(0,0,0,.35))}
    h1{font-size:clamp(1.25rem, 1rem + 2vw, 2rem);margin:0}
    p{margin:.25rem 0 .75rem;color:var(--muted)}

    .panel{
      background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
      border:1px solid var(--line);border-radius:var(--radius);padding:1rem;box-shadow:var(--shadow);
    }

    .grid{display:grid;gap:1rem}
    @media(min-width:900px){ .grid{grid-template-columns:420px 1fr;} }

    /* Formulario */
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}
    .form-row + .form-row{margin-top:.75rem}
    label{font-size:.9rem;color:var(--muted)}
    input[type="number"], textarea, input[type="text"]{
      width:100%;padding:.7rem .8rem;border-radius:12px;border:1px solid var(--line);
      background:#0e1530;color:var(--text);outline:none;
    }
    textarea{min-height:120px;resize:vertical}
    .hint{font-size:.8rem;color:var(--muted)}

    .btns{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.9rem}
    button{
      appearance:none;border:none;border-radius:999px;padding:.7rem 1rem;font-weight:600;letter-spacing:.2px;cursor:pointer
    }
    .primary{background:linear-gradient(90deg,var(--accent) 0%, var(--accent-2) 100%);color:#05111a}
    .ghost{background:transparent;border:1px solid var(--line);color:var(--text)}
    .danger{background:var(--danger);color:white}

    /* Tarjetas */
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem}
    .card{perspective:1000px}
    .flip{position:relative;min-height:160px;border-radius:18px;border:1px solid var(--line);background:linear-gradient(180deg,#0f1b3f 0%, #0d1634 100%);box-shadow:var(--shadow);transform-style:preserve-3d;transition:transform .6s;}
    .flip.is-revealed{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;padding:1rem;border-radius:18px;backface-visibility:hidden;display:flex;flex-direction:column;justify-content:flex-start}
    .front{background:linear-gradient(180deg,#0f1b3f 0%, #0d1634 100%)}
    .back{transform:rotateY(180deg);}

    .face h3{margin:.25rem 0 .35rem;font-size:1.05rem}
    .badge{display:inline-flex;align-items:center;gap:.35rem;border-radius:999px;padding:.25rem .6rem;font-size:.75rem;border:1px solid var(--line);color:var(--muted)}
    .role{margin-top:.6rem;font-size:1.05rem}

    /* Estados visuales del dorso */
    .back.fut{background:linear-gradient(180deg,rgba(0,232,135,.15) 0%, rgba(0,232,135,.07) 100%);border:1px solid rgba(0,232,135,.35)}
    .back.imp{background:linear-gradient(180deg,rgba(255,77,77,.18) 0%, rgba(255,77,77,.08) 100%);border:1px solid rgba(255,77,77,.45)}
    .role .imp-text{color:var(--danger);font-weight:800}
    .role .fut-text{color:var(--accent);font-weight:700}

    .reveal-hint{margin-top:auto;color:var(--muted);font-size:.85rem;opacity:.85}

    .toolbar{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;margin-bottom:.75rem}
    .sep{flex:1;border-top:1px dashed var(--line);opacity:.6}

    .totals{display:flex;gap:1rem;flex-wrap:wrap;color:var(--muted);font-size:.9rem}
    .totals strong{color:var(--text)}

    .error{border:1px solid #ff7878;background:#2a0f15;color:#ffd2d2;padding:.6rem .8rem;border-radius:10px;margin:.75rem 0}
    .success{border:1px solid rgba(0,232,135,.35);background:#0b1f1a;color:#baf5dc;padding:.6rem .8rem;border-radius:10px;margin:.75rem 0}

    footer{margin-top:1.25rem;color:var(--muted);font-size:.85rem;display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}
    footer a{color:var(--accent)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <span class="logo" aria-hidden="true"></span>
        <div>
          <h1>Impostor</h1>
          <p>Reparte identidades de futbolistas y designa impostores al azar.</p>
        </div>
      </div>
    </header>

    <div class="grid">
      <!-- Panel de configuración -->
      <section class="panel" aria-labelledby="cfg-title">
        <h2 id="cfg-title" style="margin:0 0 .5rem">Configuración</h2>

        <div id="msg" role="status" aria-live="polite"></div>

        <div class="form-row">
          <div>
            <label for="total">Cantidad de participantes</label>
            <input type="number" id="total" min="2" max="200" value="8" />
          </div>
          <div>
            <label for="impostores">Cantidad de impostores</label>
            <input type="number" id="impostores" min="1" max="199" value="2" />
          </div>
        </div>

        <div class="form-row">
          <div style="grid-column:1/-1">
            <label for="nombres">Nombres de los participantes (opcional, uno por línea)</label>
            <textarea id="nombres" placeholder="Ej.
Lucía
Bruno
Sofía
Mateo"></textarea>
            <div class="hint">Si no completas, se usarán nombres genéricos: Jugador 1, Jugador 2, ...</div>
          </div>
        </div>

        <div class="form-row">
          <div style="grid-column:1/-1">
            <label for="pool">Pool de futbolistas (se eligen al azar para los que NO son impostores)</label>
            <input id="pool" type="text" placeholder="Usa nuestra lista por defecto o pega tus propios nombres separados por coma" />
            <div class="hint">Ej.: Lionel Messi, Ángel Di María, Dibu Martínez, Julián Álvarez, Enzo Fernández</div>
          </div>
        </div>

        <div class="btns">
          <button class="primary" id="repartir">Repartir</button>
          <button class="ghost" id="revelarTodos">Revelar todos</button>
          <button class="ghost" id="ocultarTodos">Ocultar todos</button>
          <button class="danger" id="reiniciar">Reiniciar</button>
        </div>

        <div class="totals" id="totals" hidden>
          <div>Total participantes: <strong id="tTotal">0</strong></div>
          <div>Impostores: <strong id="tImp">0</strong></div>
          <div>Futbolistas: <strong id="tJug">0</strong></div>
        </div>
      </section>

      <!-- Panel de tarjetas / resultados -->
      <section class="panel">
        <div class="toolbar">
          <span class="badge">Consejo: Cada persona toca su tarjeta para ver su rol <strong>en secreto</strong>.</span>
          <span class="sep"></span>
          <button class="ghost" id="mezclar">Mezclar tarjetas</button>
        </div>
        <div class="cards" id="cards" aria-live="polite"></div>
      </section>
    </div>

    <footer>
      <span>⚽ Hecho para jugar en tus juntadas </span>
      <span>•</span>
      <span>Tip: podés pegar tu propia lista de futbolistas para adaptarlo a tu gusto.</span>
      <span>•</span>
      <span>Desarrollado por <strong>Ezequiel Bernardo</strong>. Si querés ayudar, podés donar al alias: <strong>ezebernardo</strong>.</span>
    </footer>
  </div>

  <script>
    // Lista de futbolistas por defecto (variada y amplia)
    const FUTBOLISTAS_BASE = [
      "Lionel Messi","Ángel Di María","Emiliano 'Dibu' Martínez","Julián Álvarez","Rodrigo De Paul","Enzo Fernández","Lautaro Martínez","Alexis Mac Allister","Cristian Romero","Nicolás Otamendi","Nahuel Molina","Leandro Paredes","Giovani Lo Celso","Gonzalo Montiel","Nicolás Tagliafico",
      "Kylian Mbappé","Erling Haaland","Kevin De Bruyne","Mohamed Salah","Virgil van Dijk","Antoine Griezmann","Jude Bellingham","Vinícius Jr.","Harry Kane","Robert Lewandowski","Luka Modrić","Toni Kroos","Pedri","Gavi","Ter Stegen",
      "Paulo Dybala","Álvaro Morata","Federico Valverde","Darwin Núñez","Luis Suárez","Edinson Cavani","Neymar Jr.","Casemiro","Raphinha","Bruno Fernandes",
      "Cristiano Ronaldo","Sergio Ramos","João Félix","Bernardo Silva","Bukayo Saka","Declan Rice","Heung-min Son","Hakim Ziyech","Sofyan Amrabat","Khvicha Kvaratskhelia",
      "Emiliano Buendía","Nicolás González","Exequiel Palacios","Germán Pezzella","Lisandro Martínez","Thiago Silva","Marcelo","Álisson Becker","Thibaut Courtois",
      "Manuel Neuer","Joshua Kimmich","Kai Havertz","Ilkay Gündogan","Phil Foden","Jack Grealish","Bernardo Silva","Riyad Mahrez","Rodri","Aurelien Tchouaméni"
    ];

    const el = (sel, root=document) => root.querySelector(sel);
    const msgBox = el('#msg');

    function showMsg(text, type='success'){
      msgBox.innerHTML = `<div class="${type}">${text}</div>`;
      if(type === 'success') setTimeout(()=> msgBox.innerHTML = '', 2500);
    }

    function parsePool(){
      const raw = el('#pool').value.trim();
      if(!raw) return [...FUTBOLISTAS_BASE];
      return raw.split(',').map(s=>s.trim()).filter(Boolean);
    }

    function getNombres(total){
      const lines = el('#nombres').value.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      if(lines.length === 0){
        return Array.from({length: total}, (_,i)=> `Jugador ${i+1}`);
      }
      // Si hay menos nombres que total, completar con genéricos
      while(lines.length < total){ lines.push(`Jugador ${lines.length+1}`); }
      return lines.slice(0,total);
    }

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
      }
      return arr;
    }

    function repartir(){
      const total = Math.max(2, Math.min(200, Number(el('#total').value||0)));
      const impostores = Math.max(1, Math.min(total-1, Number(el('#impostores').value||0)));

      if(impostores >= total){
        showMsg('La cantidad de impostores debe ser menor al total de participantes.', 'error');
        return;
      }

      // Preparar nombres y pool
      const nombres = getNombres(total);
      let pool = parsePool();
      const necesarios = total - impostores;
      if(pool.length < necesarios){
        // duplicamos aleatoriamente la lista para asegurar disponibilidad
        const base = [...pool];
        while(pool.length < necesarios){ pool = pool.concat(shuffle([...base])); }
      }

      // Asignaciones: crear array de roles
      const roles = Array.from({length: total}, (_,i)=> ({
        nombre: nombres[i],
        rol: 'IMPOSTOR',
        detalle: 'Sabotea sin ser descubierto'
      }));

      // Marcamos a los NO impostores y les damos un futbolista
      const indices = shuffle([...Array(total).keys()]);
      const noImp = indices.slice(0, necesarios);
      noImp.forEach((idx, k)=>{
        roles[idx].rol = 'FUTBOLISTA';
        roles[idx].detalle = pool[k]; // asignación única
      });

      renderTarjetas(roles);

      // Totales
      el('#tTotal').textContent = String(total);
      el('#tImp').textContent = String(impostores);
      el('#tJug').textContent = String(necesarios);
      el('#totals').hidden = false;
      showMsg('¡Roles repartidos! Cada jugador toca su tarjeta para ver su identidad.');
    }

    function renderTarjetas(roles){
      const cont = el('#cards');
      cont.innerHTML = '';
      const order = shuffle([...roles]);
      order.forEach((item, i)=>{
        const isImp = item.rol === 'IMPOSTOR';
        const flip = document.createElement('article');
        flip.className = 'card';
        const impOrFutClass = isImp ? 'imp' : 'fut';
        const roleTextClass = isImp ? 'imp-text' : 'fut-text';
        flip.innerHTML = `
          <div class="flip" tabindex="0" role="button" aria-pressed="false" aria-label="Tocar para revelar u ocultar">
            <div class="face front">
              <span class="badge">#${i+1}</span>
              <h3>${item.nombre}</h3>
              <div class="role"><strong>Tarjeta oculta</strong></div>
              <div class="reveal-hint">Tocar/clic para revelar (Enter o Espacio en teclado)</div>
            </div>
            <div class="face back ${impOrFutClass}">
              <span class="badge">#${i+1}</span>
              <h3>${item.nombre}</h3>
              <div class="role"><strong>Rol:</strong> <span class="${roleTextClass}">${item.rol}</span></div>
              <div class="role"><strong>${isImp ? 'Misión' : 'Futbolista'}:</strong> <span>${isImp ? 'Pasa desapercibido' : item.detalle}</span></div>
              <div class="reveal-hint">Tocar de nuevo para ocultar</div>
            </div>
          </div>
        `;
        const flipEl = flip.querySelector('.flip');
        const toggle = ()=>{
          flipEl.classList.toggle('is-revealed');
          const pressed = flipEl.classList.contains('is-revealed');
          flipEl.setAttribute('aria-pressed', String(pressed));
        };
        flipEl.addEventListener('click', toggle);
        flipEl.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); toggle(); }
        });
        cont.appendChild(flip);
      });
    }

    function revelarTodos(){
      document.querySelectorAll('.flip').forEach(f=>{ f.classList.add('is-revealed'); f.setAttribute('aria-pressed','true'); });
    }
    function ocultarTodos(){
      document.querySelectorAll('.flip').forEach(f=>{ f.classList.remove('is-revealed'); f.setAttribute('aria-pressed','false'); });
    }
    function ocultarTodos(){ document.querySelectorAll('.mask').forEach(m=> m.hidden = false); }
    function mezclar(){
      const cards = Array.from(document.querySelectorAll('#cards .card'));
      const parent = el('#cards');
      const frag = document.createDocumentFragment();
      shuffle(cards).forEach(c=> frag.appendChild(c));
      parent.innerHTML = '';
      parent.appendChild(frag);
    }
    function reiniciar(){
      el('#cards').innerHTML = '';
      el('#totals').hidden = true;
      msgBox.innerHTML = '';
    }

    // Eventos
    el('#repartir').addEventListener('click', repartir);
    el('#revelarTodos').addEventListener('click', revelarTodos);
    el('#ocultarTodos').addEventListener('click', ocultarTodos);
    el('#mezclar').addEventListener('click', mezclar);
    el('#reiniciar').addEventListener('click', reiniciar);

    // Accesibilidad rápida: Enter en inputs numéricos dispara repartir
    ['#total','#impostores','#pool','#nombres'].forEach(id=>{
      el(id).addEventListener('keydown', (e)=>{ if(e.key==='Enter' && (e.ctrlKey||e.metaKey||id!=='#nombres')) repartir(); });
    });
  </script>
</body>
</html>
